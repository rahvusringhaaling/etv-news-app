<script lang="ts">
  import { onDestroy } from 'svelte';
  import { language } from '../stores/language';
  import { current } from '../stores/current';
  import { gsap } from 'gsap';
  import { getMonthName, getWeekDay } from '../utils';

  let time = '';
  let date = '';
  let logoEnd: SVGElement;

  function setDate() {
    const now = new Date();

    const hours = now.getHours();
    const minutes = now.getMinutes();

    const dayNumber = now.getDate();
    const dayName = getWeekDay(now, $language);
    const monthName = getMonthName(now, $language);

    time = getFormattedTime(hours, minutes);
    date = `${dayName}, ${dayNumber}. ${monthName}`;
  }

  setDate();
  const interval = setInterval(setDate, 1000);

  function getFormattedTime(hours: number, minutes: number) {
    return `${padZeroes(hours)}:${padZeroes(minutes)}`;
  }

  function padZeroes(n: number, maxLength = 2) {
    return String(n).padStart(maxLength, '0');
  }

  const unsubscribe = current.subscribe((item) => {
    if (item) {
      gsap.to(logoEnd, { fill: item.portal.primaryColor, duration: 0.25 });
    }
  });

  onDestroy(() => {
    clearInterval(interval);
    unsubscribe();
  });
</script>

<main>
  <header>
    <div class="left">
      <div>
        <svg
          id="logo"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 131.577 39.891"
        >
          <path
            d="M17.298,23.931l2.643-7.984h.333c3.228,0,6.456,.001,9.684,0,1.837-.001,3.425-1.241,3.82-3.027,.507-2.297-.742-3.977-2.349-4.651-.438-.184-.902-.249-1.372-.275-.128-.007-.257-.007-.386-.007-4.028,0-8.056,.002-12.084-.001-1.53-.001-2.731,.629-3.627,1.858-.323,.442-.559,.928-.732,1.446-1.693,5.062-3.385,10.124-5.075,15.187-.269,.807-.394,1.635-.147,2.467,.466,1.569,1.542,2.502,3.115,2.878,.238,.057,.492,.069,.739,.069,9.362,.003,18.724,.003,28.086,.002,1.076,0,1.992-.396,2.739-1.164,.678-.697,1.142-1.532,1.449-2.448,1.967-5.871,3.926-11.745,5.895-17.615,.333-.992,.662-1.989,1.067-2.953,.737-1.751,1.809-3.284,3.235-4.548,1.873-1.66,4.055-2.664,6.537-3.018,.749-.107,1.5-.141,2.255-.142,3.798-.002,7.596,.002,11.395-.002,1.407-.001,2.787,.162,4.126,.611,1.957,.657,3.586,1.805,4.968,3.318,1.457,1.596,2.441,3.44,2.855,5.572,.249,1.281,.296,2.571,.153,3.869-.196,1.776-.743,3.431-1.73,4.92-1.823,2.749-4.286,4.613-7.55,5.328-.765,.168-1.541,.252-2.326,.256-.083,0-.165,.002-.248,.006-.015,0-.03,.016-.064,.035,.035,.059,.065,.123,.106,.177,1.568,2.088,3.138,4.175,4.707,6.262,.781,1.039,1.84,1.517,3.121,1.534,.717,.01,1.435,0,2.152,.002,1.089,.003,2.009-.4,2.762-1.175,.69-.711,1.174-1.556,1.486-2.491,1.314-3.939,2.617-7.881,3.924-11.823,.81-2.441,1.615-4.884,2.431-7.324,.69-2.062,1.745-3.91,3.304-5.441,1.897-1.863,4.155-3.039,6.789-3.466,.819-.133,1.645-.171,2.473-.171,3.817,0,7.633,.003,11.45-.001,1.407-.001,2.787,.162,4.126,.613,1.816,.612,3.357,1.65,4.682,3.02,1.515,1.566,2.576,3.387,3.061,5.525,.328,1.449,.377,2.909,.207,4.384-.525,4.546-3.801,7.989-7.193,9.43-1.124,.478-2.302,.76-3.521,.854-.402,.031-.805,.046-1.219,.069-.007,.125,.092,.194,.154,.276,1.377,1.817,2.757,3.633,4.136,5.449,.078,.103,.16,.202,.233,.308,.764,1.101,1.831,1.758,3.103,2.111,.282,.079,.569,.142,.852,.212,.003,.222-2.024,6.658-2.399,7.614-.115-.015-.239-.027-.361-.049-.771-.139-1.52-.353-2.252-.633-1.449-.555-2.63-1.49-3.697-2.59-.7-.722-1.302-1.523-1.902-2.326-2.946-3.94-5.891-7.879-8.84-11.816-.426-.568-.738-1.186-.873-1.884-.161-.834-.041-1.638,.364-2.378,.554-1.014,1.362-1.748,2.491-2.088,.437-.131,.886-.155,1.337-.155,2.584-.001,5.169-.028,7.753,.008,2.036,.029,3.924-1.67,3.959-3.909,.031-1.976-1.242-3.277-2.433-3.772-.431-.179-.882-.252-1.342-.281-.119-.008-.239-.007-.359-.007-4.046,0-8.093,0-12.139,0-1.081,0-2.046,.317-2.862,1.037-.713,.63-1.193,1.413-1.493,2.312-1.06,3.181-2.123,6.361-3.184,9.541-1.088,3.259-2.171,6.52-3.267,9.776-.567,1.684-1.343,3.265-2.452,4.663-1.836,2.315-4.197,3.788-7.104,4.362-.65,.128-1.309,.198-1.972,.198-.92,0-1.842,.04-2.758-.011-3.616-.198-6.617-1.661-8.829-4.546-3.328-4.34-6.592-8.728-9.887-13.094-.554-.734-.718-1.567-.715-2.465,.005-1.366,1.152-3.389,3.257-3.744,.324-.055,.659-.066,.989-.066,2.603-.005,5.205-.001,7.808-.004,1.782-.002,3.352-1.212,3.778-2.942,.544-2.21-.615-4.005-2.301-4.722-.455-.194-.935-.266-1.424-.289-.202-.009-.405-.007-.607-.007-3.936,0-7.872,.002-11.808-.002-1.03-.001-1.958,.285-2.769,.924-.461,.363-.831,.812-1.11,1.323-.223,.41-.429,.836-.578,1.277-1.466,4.353-2.918,8.711-4.374,13.067-.682,2.039-1.357,4.08-2.047,6.115-.62,1.826-1.48,3.527-2.74,5-1.8,2.105-4.051,3.461-6.781,3.989-.678,.131-1.364,.197-2.056,.197-9.334,0-18.669,0-28.003,0-3.129,0-5.844-1.067-8.152-3.171-1.58-1.441-2.751-3.153-3.38-5.211C.096,30.136-.047,28.746,.013,27.327c.056-1.311,.402-2.551,.813-3.785,1.605-4.82,3.196-9.644,4.796-14.466,.728-2.194,1.874-4.134,3.581-5.709C11.062,1.654,13.238,.566,15.745,.168,16.555,.04,17.372,.001,18.191,.001c3.807,0,7.615,.003,11.422-.001,1.425-.002,2.824,.159,4.182,.612,1.947,.651,3.574,1.786,4.955,3.289,1.516,1.65,2.551,3.559,2.911,5.78,.747,4.616-.607,8.496-4.182,11.555-1.453,1.243-3.128,2.052-5.002,2.44-.767,.159-1.542,.254-2.326,.254-4.184,.001-8.369,0-12.553,0h-.299Z"
          />
        </svg>
        <svg
          id="logo-end"
          bind:this={logoEnd}
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 52.522 19.932"
        >
          <path
            d="M49.671,15.941c-.098,.304-.187,.581-.277,.858-.325,.999-.651,1.997-.977,2.996-.006,.019-.015,.037-.019,.057-.01,.058-.043,.081-.101,.076-.036-.003-.072,0-.108,0-3.503,0-7.006,.005-10.509-.002-1.561-.003-2.924-.536-4.078-1.593-.565-.517-1.049-1.097-1.4-1.783-.313-.611-.505-1.259-.575-1.942-.097-.934,.029-1.835,.331-2.725,.819-2.418,1.615-4.843,2.429-7.262,.356-1.056,.904-2.002,1.699-2.792,.953-.948,2.099-1.525,3.425-1.747,.383-.064,.77-.081,1.159-.08,1.939,.002,3.879,.003,5.818,0,.685-.001,1.355,.083,2.006,.3,.83,.277,1.545,.742,2.175,1.344,.6,.573,1.078,1.232,1.401,1.999,.209,.497,.339,1.014,.404,1.549,.041,.342,.056,.685,.044,1.029-.05,1.504-.595,2.798-1.654,3.873-.392,.397-.811,.76-1.291,1.047-.665,.397-1.382,.644-2.151,.732-.289,.033-.582,.054-.873,.054-3.411,.004-6.822,.002-10.233,.002q-.187,0-.25,.176c-.136,.38-.274,.759-.407,1.14-.026,.074-.038,.155-.044,.234-.021,.262-.055,.523-.016,.789,.113,.776,.768,1.542,1.617,1.646,.123,.015,.247,.027,.37,.027,3.971,.001,7.942,.001,11.912,.001h.173Zm-12.241-7.946h.18c2.954,0,5.908,0,8.863-.002,.151,0,.302-.022,.452-.046,.947-.151,1.902-1.129,1.615-2.402-.178-.787-.666-1.302-1.456-1.51-.206-.054-.419-.056-.631-.056-1.983,0-3.966,0-5.948,0-.124,0-.248,.006-.371,.018-.618,.06-1.116,.338-1.496,.829-.203,.262-.343,.557-.448,.87-.242,.723-.482,1.447-.723,2.17-.012,.037-.021,.074-.037,.128Z"
          />
          <path
            d="M28.621,15.948c-.022,.072-.038,.129-.056,.185-.396,1.219-.793,2.439-1.189,3.658l-.007,.023c-.038,.114-.038,.115-.157,.115-3.563,0-7.126,.013-10.689-.006-1.519-.008-2.847-.559-3.968-1.592-.506-.466-.951-.982-1.29-1.584-.343-.609-.565-1.26-.658-1.953-.13-.971-.031-1.917,.288-2.847,.854-2.486,1.694-4.976,2.542-7.463,.292-.856,.723-1.636,1.316-2.322,.323-.374,.691-.697,1.095-.983,.649-.46,1.351-.804,2.126-.994,.326-.08,.657-.139,.993-.158,.227-.012,.455-.023,.683-.023,1.923-.002,3.847,.001,5.77-.002,.636-.001,1.26,.066,1.87,.249,.911,.274,1.69,.769,2.369,1.428,.604,.587,1.081,1.261,1.397,2.044,.23,.572,.356,1.167,.401,1.782,.052,.712-.005,1.413-.188,2.103-.259,.975-.775,1.799-1.476,2.515-.545,.557-1.157,1.02-1.874,1.334-.486,.213-.994,.349-1.52,.418-.338,.044-.677,.057-1.017,.056-3.371-.001-6.742,0-10.113,0-.227,0-.177-.019-.243,.179-.146,.44-.29,.88-.432,1.321-.075,.233-.077,.474-.053,.713,.065,.655,.385,1.16,.932,1.519,.291,.191,.62,.269,.966,.28,.048,.002,.096,0,.144,0,3.955,0,7.91,0,11.864,0,.054,0,.108,.004,.173,.006Zm-12.233-7.952h.18c2.947,0,5.894,0,8.841-.002,.159,0,.319-.021,.475-.047,.94-.154,1.9-1.125,1.609-2.407-.179-.786-.67-1.301-1.462-1.505-.202-.052-.411-.054-.619-.054-1.975,0-3.951,0-5.926,0-.14,0-.28,.005-.419,.02-.485,.051-.907,.241-1.259,.583-.317,.309-.518,.687-.657,1.101-.244,.727-.485,1.455-.727,2.183-.012,.037-.021,.074-.037,.128Z"
          />
          <path
            d="M2.155,19.928c-.476,0-.952,.004-1.428-.003-.122-.002-.248-.023-.363-.064-.236-.084-.346-.27-.361-.516-.015-.255,.028-.499,.108-.741,.582-1.751,1.159-3.504,1.738-5.256,.077-.232,.198-.437,.376-.604,.099-.093,.204-.18,.313-.26,.216-.157,.462-.234,.729-.238,.244-.003,.488-.002,.732-.002,.668,0,1.336-.002,2.003,.002,.127,0,.257,.009,.38,.036,.294,.064,.463,.259,.497,.557,.02,.172,.008,.339-.046,.508-.578,1.786-1.151,3.574-1.726,5.361-.075,.234-.19,.449-.341,.643-.297,.382-.696,.568-1.174,.576-.48,.008-.96,.002-1.44,.002Z"
          />
        </svg>
      </div>
      <div>
        <span class="time">{time}</span>
        <span class="date">{date}</span>
      </div>
    </div>
    <div class="right" />
  </header>
</main>

<style>
  header {
    display: flex;
  }

  header .left {
    display: flex;
    align-items: center;
    height: 167px;
    width: 1485px;

    color: #282828;
    font-size: 40px;
  }

  .left div:first-child {
    display: flex;
    align-items: flex-end;
    margin-left: 145px;
  }

  #logo {
    height: 40px;
  }

  #logo-end {
    height: 20px;
  }

  .left div:last-child {
    margin-left: 296px;
  }

  .time {
    font-weight: bold;
    margin-right: 30px;
  }

  header .right {
    width: 435px;
    height: 167px;
    background-color: #1d1d1d;
  }
</style>
